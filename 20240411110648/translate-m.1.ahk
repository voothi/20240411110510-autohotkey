; ; 20241114182044
; #Persistent

; ; Переменная, чтобы отслеживать состояние средней кнопки
; isMiddleButtonPressed := false

; ~MButton::
;     if !isMiddleButtonPressed {
;         isMiddleButtonPressed := true  ; Устанавливаем статус нажатия
;         ; Send ^c  ; Эмулируем нажатие Ctrl+C
;         ; Sleep 250  ; Задержка для предотвращения избыточного использования ресурсов
;     }

;     ; Эмулируем нажатие средней кнопки мыши, пока она зажата
;     while isMiddleButtonPressed {
;         Sleep 250  ; Задержка для предотвращения избыточного использования ресурсов
;         Send ^c  ; Эмулируем нажатие Ctrl+C
;         Send {MButton down}  ; Эмулируем нажатие средней кнопки
;     }

;     ; Отпускаем среднюю кнопку, когда она отпущена
;     Send {MButton up}
; return

; ; Обработчик отпускания средней кнопки мыши
; ~MButton Up::
;     isMiddleButtonPressed := false  ; Сбрасываем статус нажатия
; return

; #Persistent

; ; Переменные для отслеживания состояния
; isSelectionMode := false  ; Режим выделения включен или нет
; isLeftButtonPressed := false  ; Состояние левой кнопки мыши

; ; Комбинация клавиш для включения/выключения режима
; ^!y::  ; Ctrl + Alt + Y
;     isSelectionMode := !isSelectionMode  ; Переключаем режим выделения
;     if (isSelectionMode) {
;         ToolTip, Режим выделения включен! ; Показываем уведомление
;         Sleep, 1500  ; Задержка для показа уведомления
;         ToolTip  ; Убираем уведомление
;     } else {
;         ToolTip, Режим выделения выключен! ; Показываем уведомление
;         Sleep, 1500  ; Задержка для показа уведомления
;         ToolTip  ; Убираем уведомление
;     }
; return

; ; Обработчик нажатия левой кнопки мыши
; ~LButton::
;     if (isSelectionMode) {
;         isLeftButtonPressed := true  ; Устанавливаем состояние нажатия
;         KeyWait, LButton  ; Ожидаем отпускания левой кнопки мыши
;         isLeftButtonPressed := false  ; Сбрасываем состояние нажатия
;         Send ^c  ; Эмулируем нажатие Ctrl+C
;         Send ^c  ; Эмулируем нажатие Ctrl+C
;     }
; return

; ; Обработчик отпускания левой кнопки мыши
; ~LButton Up::
;     if (isSelectionMode) {
;         ; Здесь можно добавить дополнительные действия при отпускании кнопки
;         ; Например, если нужно что-то сделать, когда кнопка отпущена
;     }
; return

; 20241115164746
; #Persistent

; ; Переменные для отслеживания состояния
; isSelectionMode := false  ; Режим выделения включен или нет
; isLeftButtonPressed := false  ; Состояние левой кнопки мыши
; previousClipboard := ""  ; Переменная для хранения предыдущего состояния буфера обмена

; ; Комбинация клавиш для включения/выключения режима
; ^!y::  ; Ctrl + Alt + Y
;     isSelectionMode := !isSelectionMode  ; Переключаем режим выделения
;     if (isSelectionMode) {
;         ToolTip, Режим выделения ВКЛЮЧЕН! ; Показываем уведомление
;         Sleep, 1500  ; Задержка для показа уведомления
;         ToolTip  ; Убираем уведомление
;     } else {
;         ToolTip, Режим выделения ВЫКЛЮЧЕН! ; Показываем уведомление
;         Sleep, 1500  ; Задержка для показа уведомления
;         ToolTip  ; Убираем уведомление
;     }
; return

; ; Обработчик нажатия левой кнопки мыши
; ~LButton::
;     if (isSelectionMode) {
;         isLeftButtonPressed := true  ; Устанавливаем состояние нажатия
;         KeyWait, LButton  ; Ожидаем отпускания левой кнопки мыши
;         isLeftButtonPressed := false  ; Сбрасываем состояние нажатия

;         ; Сохраняем текущее состояние буфера обмена
;         ClipSaved := ClipboardAll  ; Сохраняем текущее состояние буфера обмена
;         Send ^c  ; Эмулируем нажатие Ctrl+C
;         Send ^c  ; Эмулируем нажатие Ctrl+C

;         ; Проверяем, изменился ли буфер обмена
;         ClipWait, 1  ; Ждем, пока буфер обмена не изменится
;         if (Clipboard != ClipSaved) {
;             ; Если буфер обмена изменился, сохраняем новое состояние
;             previousClipboard := Clipboard
;         } else {
;             ; Если буфер обмена не изменился, восстанавливаем предыдущее состояние
;             Clipboard := ClipSaved
;         }
;     }
; return

; ; Обработчик отпускания левой кнопки мыши
; ~LButton Up::
;     if (isSelectionMode) {
;         ; Здесь можно добавить дополнительные действия при отпускании кнопки
;     }
; return

; 20241115165401
#Persistent

; Переменные для отслеживания состояния
isSelectionMode := false  ; Режим выделения включен или нет
isLeftButtonPressed := false  ; Состояние левой кнопки мыши
previousClipboard := ""  ; Переменная для хранения предыдущего состояния буфера обмена
lastClickTime := 0  ; Время последнего нажатия
doubleClickThreshold := 300  ; Порог времени для определения двойного клика в миллисекундах
doubleClickDelay := 500  ; Задержка для перевода в миллисекундах

; Комбинация клавиш для включения/выключения режима
^!y::  ; Ctrl + Alt + Y
    isSelectionMode := !isSelectionMode  ; Переключаем режим выделения
    if (isSelectionMode) {
        ToolTip, Режим выделения ВКЛЮЧЕН! ; Показываем уведомление
        Sleep, 1500  ; Задержка для показа уведомления
        ToolTip  ; Убираем уведомление
    } else {
        ToolTip, Режим выделения ВЫКЛЮЧЕН! ; Показываем уведомление
        Sleep, 1500  ; Задержка для показа уведомления
        ToolTip  ; Убираем уведомление
    }
return

; Обработчик нажатия левой кнопки мыши
~LButton::
    currentTime := A_TickCount  ; Получаем текущее время

    if (isSelectionMode) {
        ; Проверяем, произошел ли двойной клик
        if (currentTime - lastClickTime < doubleClickThreshold) {
            ; Двойной клик обнаружен, ждем половину секунды, чтобы перевести слово
            Sleep, doubleClickDelay  ; Задержка на 500 мс
            Send ^c  ; Эмулируем нажатие Ctrl+C
            ClipWait, 1  ; Ждем, пока буфер обмена не обновится
            return  ; Завершаем выполнение, чтобы не выполнять дальнейшую логику
        }

        lastClickTime := currentTime  ; Обновляем время последнего нажатия

        isLeftButtonPressed := true  ; Устанавливаем состояние нажатия
        KeyWait, LButton  ; Ожидаем отпускания левой кнопки мыши
        isLeftButtonPressed := false  ; Сбрасываем состояние нажатия

        ClipSaved := Clipboard  ; Сохраняем текущее состояние буфера обмена

        ; Проверяем, изменился ли буфер обмена
        if (ClipSaved != previousClipboard) {
            ; Выполняем копирование текста
            Send ^c  ; Эмулируем нажатие Ctrl+C

            ; Ждем, пока буфер обмена не обновится
            ClipWait, 1  ; Ждем, пока буфер обмена не изменится
            ; Если буфер обмена изменился, сохраняем новое состояние
            previousClipboard := Clipboard  ; Обновляем предыдущее состояние
        }
    }
return

; Обработчик отпускания левой кнопки мыши
~LButton Up::
; Здесь ничего не нужно делать, так как логика уже реализована в обработчике нажатия
return