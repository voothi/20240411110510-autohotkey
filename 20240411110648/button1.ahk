; ====================================================================================
; --- Script Logic ---
; Этот скрипт разделяет функции: обычное нажатие для клика/выделения
; и Ctrl+нажатие для прокрутки.
; ====================================================================================

; --- Функции прокрутки ---

GetScrollCount() {
    if WinActive("ahk_exe chrome.exe") {
        return 3
    }
    return 1
}

ScrollDownTimer() {
    loop GetScrollCount() {
        Send("{WheelDown}")
        Sleep(50)
    }
}

; --- Горячие клавиши ---

; Хоткей для ПРОКРУТКИ: Ctrl + кнопка стилуса
; Срабатывает, только если зажат Ctrl
^!sc028::
{
    SetTimer(ScrollDownTimer, 50)
}

; Останавливает прокрутку при отпускании
^!sc028 up::
{
    SetTimer(ScrollDownTimer, 0)
}


; Хоткей для КЛИКА и ВЫДЕЛЕНИЯ: кнопка стилуса БЕЗ Ctrl
; Символ "~" позволяет "пропустить" нажатие дальше,
; чтобы система получила его как обычный Ctrl+Alt+'
; а "$", чтобы хоткей не запускал сам себя.
$~!sc028::
{
    ; Проверяем, что Ctrl НЕ зажат
    if !GetKeyState("Control", "P")
    {
        ; Имитируем зажатие Левой Кнопки Мыши
        Send("{LButton Down}")
        
        ; Ждем, пока пользователь отпустит кнопку стилуса
        KeyWait("sc028")
        
        ; Имитируем отпускание Левой Кнопки Мыши
        Send("{LButton Up}")
    }
}